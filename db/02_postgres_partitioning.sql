\connect archive

DROP TABLE IF EXISTS archive.sample;
CREATE TABLE archive.sample
(
   channel_id BIGINT NOT NULL,
   smpl_time TIMESTAMP NOT NULL,
   nanosecs BIGINT  NOT NULL,
   severity_id BIGINT NOT NULL,
   status_id BIGINT  NOT NULL,
   num_val INT NULL,
   float_val REAL NULL,
   str_val VARCHAR(120) NULL,
   datatype CHAR(1) NULL DEFAULT ' ',
   array_val BYTEA  NULL
) PARTITION BY RANGE (smpl_time);

CREATE TABLE sample_before201812 PARTITION OF sample
 FOR VALUES FROM ('2000–01–01') TO ('2018–12–01');
CREATE TABLE sample_201812 PARTITION OF sample
 FOR VALUES FROM ('2018–12–01') TO ('2019–01–01');
CREATE TABLE sample_201901 PARTITION OF sample
 FOR VALUES FROM ('2019–01–01') TO ('2019–02–01');
CREATE TABLE sample_201902 PARTITION OF sample
 FOR VALUES FROM ('2019–02–01') TO ('2019–03–01');
CREATE TABLE sample_201903 PARTITION OF sample
 FOR VALUES FROM ('2019–03–01') TO ('2019–04–01');
CREATE TABLE sample_201904 PARTITION OF sample
 FOR VALUES FROM ('2019–04–01') TO ('2019–05–01');
CREATE TABLE sample_201905 PARTITION OF sample
 FOR VALUES FROM ('2019–05–01') TO ('2019–06–01');
CREATE TABLE sample_201906 PARTITION OF sample
 FOR VALUES FROM ('2019–06–01') TO ('2019–07–01');
CREATE TABLE sample_201907 PARTITION OF sample
 FOR VALUES FROM ('2019–07–01') TO ('2019–08–01');
CREATE TABLE sample_201908 PARTITION OF sample
 FOR VALUES FROM ('2019–08–01') TO ('2019–09–01');
CREATE TABLE sample_201909 PARTITION OF sample
 FOR VALUES FROM ('2019–09–01') TO ('2019–10–01');
CREATE TABLE sample_201910 PARTITION OF sample
 FOR VALUES FROM ('2019–10–01') TO ('2019–11–01');
CREATE TABLE sample_201911 PARTITION OF sample
 FOR VALUES FROM ('2019–11–01') TO ('2019–12–01');
CREATE TABLE sample_201912 PARTITION OF sample
 FOR VALUES FROM ('2019–12–01') TO ('2020–01–01');
CREATE TABLE sample_202001 PARTITION OF sample
 FOR VALUES FROM ('2020–01–01') TO ('2020–02–01');
CREATE TABLE sample_default PARTITION OF sample
 DEFAULT;

GRANT SELECT, INSERT, UPDATE, DELETE ON sample TO archive;
GRANT SELECT ON sample TO report;
GRANT SELECT ON ALL TABLES IN SCHEMA archive TO report;

ALTER TABLE sample OWNER TO archive;

COMMIT;
